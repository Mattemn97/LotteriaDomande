<!DOCTYPE html>
<html>
<head>
    <title>Quiz</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script>
        // === Timer countdown ===
        let tempoRimasto = {{ tempo_sessione_minuti * 60 }};
        function aggiornaTimer() {
            const timer = document.getElementById("timer");
            const minuti = Math.floor(tempoRimasto / 60);
            const secondi = tempoRimasto % 60;
            timer.textContent = minuti.toString().padStart(2, '0') + ":" + secondi.toString().padStart(2, '0');
            if (tempoRimasto <= 0) {
                clearInterval(contatore);
                alert("Tempo scaduto! Le risposte verranno inviate automaticamente.");
                document.getElementById("quizForm").submit();
            }
            tempoRimasto--;
        }
        let contatore = setInterval(aggiornaTimer, 1000);
        window.onload = aggiornaTimer;
    </script>
</head>
<body class="w3-light-grey">
    <div class="w3-container w3-center w3-margin-top">
        <div class="w3-card-4 w3-white w3-padding-32 w3-round-large" style="max-width:1600px;margin:auto;">
            <h2 class="w3-text-{{ colore_primario }}">Domande</h2>

            <!-- Timer visibile -->
            <div class="w3-panel w3-{{ colore_primario }} w3-round-large w3-padding-small w3-margin-bottom" style="width:150px;margin:auto;">
                <strong>Tempo:</strong> <span id="timer">00:00</span>
            </div>

            <form id="quizForm" method="POST">
                {% for d in domande %}
                    <div class="w3-margin-top w3-padding w3-round-large w3-border-top">
                        <p><strong>{{ loop.index }}. {{ d["Domanda"] }}</strong></p>
                        <div class="w3-row-padding">
                            {% for r in d.risposte %}
                                <div class="w3-col m3 s6">
                                    <label class="w3-radio w3-block">
                                        <input class="w3-radio" type="radio" name="domanda_{{ d['Id Domanda'] }}" value="{{ r }}" required>
                                        {{ r }}
                                    </label>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
                <button class="w3-button w3-{{ colore_primario }} w3-margin-top w3-round-large" type="submit">Conferma tutte le risposte</button>
            </form>
        </div>
    </div>
</body>
</html>
